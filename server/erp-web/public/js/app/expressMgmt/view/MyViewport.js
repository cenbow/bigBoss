/*
 * File: app/view/MyViewport.js
 *
 * This file was generated by Sencha Architect version 3.5.1.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('ExpressMgmt.view.MyViewport', {
  extend: 'Ext.container.Viewport',
  alias: 'widget.myviewport',

  requires: [
    'Common.ux.PagingToolbarResizer',
    'ExpressMgmt.view.MyViewportViewModel',
    'ExpressMgmt.view.MyViewportViewController',
    'Ext.ux.ProgressBarPager',
    'Ext.button.Button',
    'Ext.form.field.Text',
    'Ext.form.trigger.Trigger',
    'Ext.grid.Panel',
    'Ext.grid.column.Action',
    'Ext.grid.column.RowNumberer',
    'Ext.toolbar.Fill',
    'Ext.toolbar.Paging',
    'Common.ux.CommandColumn'
  ],
  controller: 'myviewport',
  viewModel: {
    type: 'myviewport'
  },
  layout: 'fit',

  items: [
    {
      xtype: 'gridpanel',
      header: false,
      bind: {
        store: '{logisticsstore}'
      },
      dockedItems: [
        {
          xtype: 'toolbar',
          dock: 'top',
          items: [
            {
              xtype: 'button',
              iconCls: 'btn-add',
              text: '添加物流信息',
              width: 120,
              listeners: {
                click: 'onButtonClick'
              }
            },

            {
              xtype: 'tbfill'
            },
            {
              xtype: 'textfield',
              fieldLabel: '快速搜索',
              labelAlign: 'right',
              emptyText: '输入快递公司名称',
              listeners: {
                specialKey: 'onFastSearchTextFieldSpecialKey'
              },
              triggers: {
                mytrigger: {
                  handler: 'onButtonSearchClick',
                  cls: 'x-form-search-trigger'
                }
              }
            }
          ]
        },
        {
          xtype: 'pagingcustomtoolbar',
          dock: 'bottom',
          displayInfo: true,
          bind: {
            store: '{logisticsstore}'
          }
        }
        /*,
        {
          xtype: 'pagingtoolbar',
          dock: 'bottom',
          displayInfo: true,
          bind: {
            store: '{logisticsstore}'
          },
          plugins: [
            Ext.create('Ext.ux.ProgressBarPager'),
            {
              ptype: 'pagingtoolbarresizer'
            }
          ]
        }*/
      ],

      plugins: {
        ptype: 'cellediting',
        clicksToEdit: 1
      },
      columns: {
        defaults: {
          align: 'center',
          tdCls: 'with-btngroup'
        },
        items: [
          {
            text: '序号',
            xtype: 'rownumberer',
            width: 37
          },
          {
            text: '操作',
            xtype: 'widgetcolumn',
            width: 250,
            tdCls: 'btngroup',
            dataIndex: 'progress',
            widget: {
              xtype: 'buttongroup',
              baseCls: '',
              layout: {
                type: 'column'
              },
              defaultBindProperty: 'permission',
              setPermission: function(){
                var buttonGroup = this,
                  btnArray = buttonGroup.items.items,
                  record = btnArray[0].ownerCt.getWidgetRecord();

                if (Ext.Array.contains(_USER.permissions, "expressMgmt:edit")) {

                  if (record.get('isSysCopied') == 'Y') {
                    btnArray[2].setDisabled(true);
                  } else {
                    btnArray[2].setDisabled(false);
                  }
                } else {
                  Ext.Array.each(btnArray, function(item, index) {
                    item.setDisabled(true);
                  });
                }

              },
              defaults: {
                handler: 'onCommandColumnClick'
              },
              items: [{
                xtype: 'button',
                command: 'Update',
                iconCls: 'btn-edit',
                text: '修改'
              }, {
                xtype: 'button',
                command: 'Setting',
                iconCls: 'btn-cost',
                text: '运费成本设置'
              }, {
                xtype: 'button',
                command: 'Delete',
                iconCls: 'btn-delete',
                text: '删除'
              }]
            }
          },
          {
            xtype: 'gridcolumn',
            tdCls: 'grid-switch',
            dataIndex: 'activeFlag',
            text: '是否启用',
            renderer: function (value, metadata, record, rowIndex, colIndex, store, view) {
              if (value === 'A') {
                return '<img src="/images/SwitchOn.png" />';
              } else {
                return '<img src="/images/SwitchOff.png" />';
              }
            }
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'isSysCopied',
            text: '系统预设',
            renderer: function (value) {
              if (value === 'Y') {
                return '是';
              } else {
                return '否';
              }
            }
          },
          {

            xtype: 'gridcolumn',
            dataIndex: 'priority',
            hidden: true,
            text: '优先级',
            editor: {
              xtype: 'numberfield'
            }
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'name',
            text: '快递公司'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'contactName',
            text: '联系人'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'contactPhone',
            text: '联系电话'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'printTplName',
            text: '普通面单模版'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'eWaybillPrintTplName',
            text: '电子面单模版'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'codPrintTplName',
            text: '货到付款模板'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'keywords',
            text: '物流关键字'
          },
          {
            xtype: 'gridcolumn',
            dataIndex: 'memo',
            text: '备注',
            flex: 1
          }
        ]
      },
      listeners: {
        cellclick: 'cellclick',
        itemdblclick: 'itemdblclick'
      }
    }
  ]
});