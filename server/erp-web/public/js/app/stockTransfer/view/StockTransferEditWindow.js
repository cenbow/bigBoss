/*
 * File: app/view/StockTransferEditWindow.js
 *
 * This file was generated by Sencha Architect version 3.5.1.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('StockTransfer.view.StockTransferEditWindow', {
  extend: 'Ext.window.Window',
  alias: 'widget.stocktransfereditwindow',

  requires: [
    'StockTransfer.view.StockTransferEditWindowViewModel',
    'StockTransfer.view.StockTransferEditWindowViewController',
    'Ext.form.Panel',
    'Ext.toolbar.Toolbar',
    'Ext.toolbar.Fill',
    'Ext.button.Button',
    'Ext.form.field.ComboBox',
    'Ext.form.field.Date',
    'Ext.form.field.TextArea',
    'Ext.grid.Panel',
    'Ext.view.Table',
    'Ext.grid.column.Number'
  ],

  controller: 'stocktransfereditwindow',
  viewModel: {
    type: 'stocktransfereditwindow'
  },
  height: 400,
  width: 900,
  bodyStyle: {
    background: '#fff'
  },
  layout: 'fit',
  bodyPadding: 5,
  title: '库存调拨',
  modal: true,
  autoScroll: true,

  items: [
    {
      xtype: 'panel',
      border: false,
      header: false,
      title: 'My Panel',
      layout: 'border',
      bodyStyle: {
        background: '#fff'
      },
      items: [
        {
          xtype: 'form',
          defaults: {
            columnWidth: 0.5,
            margin: 2,
            labelAlign: 'left',
            labelWidth: 100
          },
          layout: 'column',
          header: false,
          title: 'My Form',
          border: false,
          region: 'north',
          items: [
            {
              xtype: 'textfield',
              name: 'id',
              hidden: true,
              bind: {
                value: '{id}'
              }
            },
            {
              xtype: 'combobox',
              name: 'type',
              fieldLabel: '调拨类型' + '<font color=red>*</font>',
              editable: false,
              displayField: 'name',
              valueField: 'code',
              queryMode: 'local',
              emptyText: "请选择",
              allowBlank: false,
              blankText: '调拨类型不能空',
              bind: {
                store: '{stockTransferTypeStore}',
                value: '{type}'
              }
            },
            {
              xtype: 'datefield',
              name: 'postDate',
              fieldLabel: '调拨日期',
              editable: false,
              format: "Y/n/j",
              /*valueToRaw : function ( value ) {
                var me = this;
                return value ? me.formatDate(new Date(Number(value))) : "";
              },*/
              valueToRaw: function(value) {
                var me = this;
                if(!Ext.isDate(value)) {
                  value = new Date(Number(value))
                }
                return me.formatDate(me.parseDate(value));
              },
              bind: {
                value: '{postDate}'
              }
            },
            {
              itemId: 'fromWhs',
              xtype: 'combobox',
              name: 'fromWhsId',
              fieldLabel: '从仓库' + '<font color=red>*</font>',
              editable: false,
              displayField: 'name',
              valueField: 'id',
              emptyText: "请选择",
              queryMode: 'local',
              allowBlank: false,
              blankText: '仓库不能空',
              bind: {
                store: '{fromWhsStore}',
                value: '{fromWhsId}'
              },
              listeners: {
                change: 'onFromWhsChange'
              }
            },
            {
              itemId: 'fromWhsArea',
              xtype: 'combobox',
              name: 'fromWhsAreaId',
              fieldLabel: '从库区' + '<font color=red>*</font>',
              editable: false,
              displayField: 'name',
              valueField: 'id',
              emptyText: "请选择",
              queryMode: 'local',
              allowBlank: false,
              blankText: '库区不能空',
              forceSelection : true,
              bind: {
                store: '{fromWhsAreaStore}',
                value: '{fromWhsAreaId}'
              },
              listeners: {
                change: 'onFromWhsAreaChange'
              }
            },
            {
              itemId: 'toWhs',
              xtype: 'combobox',
              name: 'toWhsId',
              fieldLabel: '至仓库' + '<font color=red>*</font>',
              editable: false,
              displayField: 'name',
              valueField: 'id',
              emptyText: "请选择",
              queryMode: 'local',
              allowBlank: false,
              blankText: '仓库不能空',
              bind: {
                store: '{toWhsStore}',
                value: '{toWhsId}'
              },
              listeners: {
                change: 'onToWhsChange'
              }
            },
            {
              itemId: 'toWhsArea',
              xtype: 'combobox',
              name: 'toWhsAreaId',
              fieldLabel: '至库区' + '<font color=red>*</font>',
              editable: false,
              displayField: 'name',
              valueField: 'id',
              emptyText: "请选择",
              queryMode: 'local',
              allowBlank: false,
              blankText: '库区不能空',
              forceSelection : true,
              bind: {
                store: '{toWhsAreaStore}',
                value: '{toWhsAreaId}'
              },
              listeners: {
                change: 'onToWhsAreaChange'
              }
            },
            {
              xtype: 'textareafield',
              name: 'memo',
              columnWidth: 1,
              fieldLabel: '备注',
              maxLength: 255,
              maxLengthText: '备注不能超过255个字符',
              bind: {
                value: '{memo}'
              }
            }
          ]
        },
        {
          xtype: 'gridpanel',
          header: false,
          padding: 2,
          region: 'center',
          title: 'My Grid Panel',
          /*store: 'TransferDetailJsonStore',*/
          bind: {
            store: '{transferDetailStore}'
          },
          dockedItems: [
            {
              xtype: 'toolbar',
              dock: 'top',
              items: [
                {
                  xtype: 'button',
                  text: '添加',
                  iconCls: 'btn-add',
                  listeners: {
                    click: 'onButtonLineAddClick'
                  }
                },
                {
                  xtype: 'button',
                  text: '商品批量导入',
                  iconCls: 'btn-batch-import',
                  listeners: {
                    click: 'onButtonBatchInputClick'
                  }
                },
                {
                  xtype: 'textfield',
                  fieldLabel: '扫描条码',
                  labelWidth: 60,
                  listeners: {
                    specialKey: 'onFastSearch'
                  }
                }
              ]
            }
          ],
          selModel: 'cellmodel',
          plugins: {
            ptype: 'cellediting',
            clicksToEdit: 1,
          },
          columns: {
            defaults: {
              align: 'center',
              tdCls: 'with-btngroup'
            },
            items: [

              {
                text: '序号',
                xtype: 'rownumberer',
                width: 50
              },
              {
                text: '操作',
                hideable: false,
                xtype: 'widgetcolumn',
                width: 40,
                tdCls: 'btngroup',
                widget: {
                  xtype: 'buttongroup',
                  baseCls: '',
                  layout: {
                    type: 'column'
                  },
                  defaults: {
                    handler: 'onCommandColumnClick'
                  },
                  items: [
                    {xtype: 'button', command: 'Delete', iconCls: 'btn-delete'}
                  ]
                }
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'skuCode',
                editor: {
                  xtype: 'textfield',
                  triggers: {
                    mytrigger: {
                      handler: 'onButtonChooseClick',
                      cls: 'x-form-ellipsis-trigger'
                    }
                  }
                },
                text: '规格编码<span class="pencil"/>'
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'productCode',
                text: '商品编码'
              },
              /*{
                xtype: 'gridcolumn',
                dataIndex: 'productName',
                text: '商品名称'
              },*/

              {
                xtype: 'gridcolumn',
                dataIndex: 'skuName',
                text: '规格名称'
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'fromWhsAreaId',
                editor: {
                  xtype: 'combobox',
                  editable: false,
                  displayField: 'name',
                  valueField: 'id',
                  emptyText: "请选择",
                  queryMode: 'local',
                  forceSelection: true,
                  bind: {
                    value: '{name}',
                    store: '{fromWhsAreaStore}'
                  },

                },
                renderer: 'renderFromAreaStore',
                text: '发货库区<span class="pencil"/>',
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'fromWhsPickLoc',
                text: '发货库位'
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'availableStock',
                text: '可用库存'
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'toWhsAreaId',
                editor: {
                  xtype: 'combobox',
                  editable: false,
                  displayField: 'name',
                  valueField: 'id',
                  emptyText: "请选择",
                  queryMode: 'local',
                  forceSelection: true,
                  bind: {
                    store: '{toWhsAreaStore}'
                  }
                },
                renderer: 'renderToAreaStore',
                text: '收货库区<span class="pencil"/>',
              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'toWhsPickLoc',
                text: '收货库位'
              },
              {
                xtype: 'numbercolumn',
                dataIndex: 'quantity',
                editor: {
                  xtype: 'numberfield',
                  minValue: 1
                },
                format: 0,
                text: '调拨数量<span class="pencil"/>'

              },
              {
                xtype: 'gridcolumn',
                dataIndex: 'memo',
                editor: {
                  xtype: 'textfield',
                  maxLength: 255,
                  enforceMaxLength: true
                },
                text: '备注<span class="pencil"/>'
              }

            ]
          }
        }
      ]
    }
  ],
  dockedItems: [
    {
      xtype: 'toolbar',
      dock: 'bottom',
      ui: 'footer',
      items: [
        {
          xtype: 'tbfill'
        },
        {
          itemId: 'saveDraftBtn',
          xtype: 'button',
          iconCls: 'btn-save',
          handler: 'onButtonSaveDraftClick',
          text: '保存至草稿'

        },
        {
          itemId: 'savePostBtn',
          xtype: 'button',
          iconCls: 'btn-save',
          handler: 'onButtonSavePostClick',
          text: '保存并调拨'
        },
        {
          itemId: 'cancelBtn',
          xtype: 'button',
          iconCls: 'btn-cancel',
          handler: 'onButtonCancelClick',
          text: '取消调拨'
        },
        {
          itemId: 'closeBtn',
          xtype: 'button',
          iconCls: 'btn-cancel',
          handler: 'onButtonCloseClick',
          text: '关闭'
        }
      ]
    }
  ]

});