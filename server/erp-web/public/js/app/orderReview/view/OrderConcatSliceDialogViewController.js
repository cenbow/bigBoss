/*
 * File: app/view/LogDiffDialogViewController.js
 *
 * This file was generated by Sencha Architect version 3.5.1.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('OrderReview.view.OrderConcatSliceDialogViewController', {
  extend: 'Ext.app.ViewController',
  alias: 'controller.orderconcatslicedialog',
  uses: [
    'OrderReview.view.RowSliceDialog'
  ],

  /*确认合并*/
  onButtonOkConcatClick: function (button, e, eOpts) {
    console.info("确认合并");
  },

  /*确认拆分*/
  onButtonOkSliceClick: function (button, e, eOpts) {
    console.info("确认拆分");
  },

  /*取消*/
  onButtonCloseClick: function (button, e, eOpts) {
    var viewCtr = this;
    viewCtr.closeView();
  },

  /*商品编码列渲染*/
  onShopSkuRenderer: function(v) {
    return v == "magnam" ? ("<span style='color:red;'>" + v + "</span>") : v;
  },

  /**
   * 主页命令行操作
   */
  onCommandColumnClick: function (btn, event) {
    var viewCtr = this,
        command = btn.command,
        grid = viewCtr.lookupReference('centergrid'),
        record = btn.ownerCt.getWidgetRecord();

    event.stopEvent();
    grid.getSelectionModel().select(record);

    if (command == 'Slice') {
      viewCtr._openSliceDialog(record, grid.getStore());
    }
  },

  /*开打拆分对话框*/
  _openSliceDialog: function(record, store) {
    if (!record.get('A06') || Number(record.get('A06')) <= 1) {
      TipsUtil.showTips('提示', '商品数量大于1才能进行拆分操作', TipsUtil.WARING);
      return;
    }

    var dialog = Ext.create('OrderReview.view.RowSliceDialog');
    var dialogVM = dialog.getViewModel();
    dialogVM.set("referStore", store );
    dialogVM.set("referRecord", record );
    dialog.lookupReference('row1').setValue(record.get('A06') - 1);
    dialog.lookupReference('row2').setValue(1);
    dialog.lookupReference('row2').previousNode().setDisabled(true);
  }

});
